<html><head>


<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>SOUNDLIGHT USBDMX Interfaces </title>
</head><body link="#0000ff" vlink="#800080">

<p align="center"><font face="Arial"><strong><big>Make your own software with
DASHARD.DLL,  USBDMXVB.DLL</big><br>
<big>and our Intelligent USBDMX1 / USBDMX2 Interface</big></strong></font></p>

<p><font face="Arial">The DASHARD.DLL is a 32 bit Windows DLL (Dynamic Link Library). The library
works with Windows 98, ME, 2000 and XP. It has been tested on Visual C++, Visual Basic, C++
Builder, and Delphi.</font></p>

<hr>

<p align="left"><font face="Arial">The DASHARD.DLL contains only one function :</font></p>

<p align="left"><font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
<u><i>C++ style</i></u> </font></p>
<p align="left"><font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
int <strong>DasHardCommand</strong>(&nbsp;
int <strong>command</strong>,&nbsp;&nbsp; int <strong>param</strong>,&nbsp;&nbsp; unsigned
char *<strong>bloc</strong> );</font></p>

<p align="left"><font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
<u><i>Visual Basic style</i></u> </font></p>
<p align="left"><font face="Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Declare Function <b>DasHardCommand</b> Lib "<b>USBDMXVB.DLL</b>" Alias "_DasHardCommand@12" <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(ByVal <b>Command</b> As Integer, ByVal <b>Param</b> As Integer, ByRef <b>dmxdata</b> As Byte) As Long
</font></p>
<p>

</p><p align="left"><font face="Arial">The first parameter &lt;<em>command</em>&gt; defines
the thing to do :</font></p>

<table border="1" width="90%">
  <tbody><tr>
    <td width="11%"><font face="Arial" size="1">int command</font></td>
    <td width="25%"><font face="Arial" size="1">explanation</font></td>
    <td width="25%"><font face="Arial" size="1">works with</font></td>
    <td width="28%"><font face="Arial" size="1">int param</font></td>
    <td width="14%"><font face="Arial" size="1">unsigned char *bloc</font></td>
    <td width="38%"><font face="Arial" size="1">return value (int)</font></td>
  </tr>
  <tr>
    <td width="11%"><font face="Arial" size="1">DHC_OPEN</font></td>
    <td width="25%"><font face="Arial" size="1">allow to open the communication with the
    interface</font></td>
    <td width="25%"><font face="Arial" size="1">ALL INTERFACES</font></td>
    <td width="28%"><font face="Arial" size="1">Enter 0 to open any interface.<br>
      <br>
      Enter 3 to open USBDMX1<br>
      Enter 11&nbsp; to open USBDMX2<br></font></td>
    <td width="14%"><font face="Arial" size="1">not used</font></td>
    <td width="38%"><font face="Arial" size="1">Positive value if the function succeeds.<br>
      &nbsp; return&nbsp; 3 with USBDMX1<br>
      &nbsp; return 11 with USBDMX2<br>
      &nbsp; return a specific value with <br>
      Negative value if the function fails.</font></td>
  </tr>
  <tr>
    <td width="11%"><font face="Arial" size="1">DHC_CLOSE</font></td>
    <td width="25%"><font face="Arial" size="1">allow to close the communication with the
    interface</font></td>
    <td width="25%"><font face="Arial" size="1">ALL INTERFACES</font></td>
    <td width="28%"><font face="Arial" size="1">not used</font></td>
    <td width="14%"><font face="Arial" size="1">not used</font></td>
    <td width="38%"><font face="Arial" size="1">DHE_OK&nbsp; If the function succeeds.<br>
    DHE_ERROR_NOTOPEN&nbsp; If the interface is not open.<br>
    DHE_ERROR_COMMAND&nbsp; If the function fails.</font></td>
  </tr>
  <tr>
    <td width="11%"><font face="Arial" size="1">DHC_DMXOUTOFF</font></td>
    <td width="25%"><font face="Arial" size="1">allow to clean the DMX ouput (force all levels
    to 0)</font></td>
    <td width="25%"><font face="Arial" size="1">USBDMX1&nbsp;
      &nbsp;&nbsp; USBDMX2</font></td>
    <td width="28%"><font face="Arial" size="1">not used</font></td>
    <td width="14%"><font face="Arial" size="1">not used</font></td>
    <td width="38%"><font face="Arial" size="1">DHE_OK&nbsp; If the function succeeds<br>
    DHE_ERROR_NOTOPEN&nbsp; If the interface is not open.<br>
    DHE_DMXOUT_PACKWRITE&nbsp; If the communication fails.</font></td>
  </tr>
  <tr>
    <td width="11%"><font face="Arial" size="1">DHC_DMXOUT</font></td>
    <td width="25%"><font face="Arial" size="1">allow to send a DMX block to the interface</font></td>
    <td width="25%"><font face="Arial" size="1">USBDMX1&nbsp;
      &nbsp;&nbsp; USBDMX2</font></td>
    <td width="28%"><font face="Arial" size="1">Specifies the size, in bytes, of the DMX block
    of memory to send</font></td>
    <td width="14%"><font face="Arial" size="1">Pointer to the DMX block of memory to send</font></td>
    <td width="38%"><font face="Arial" size="1">DHE_OK&nbsp; If the function succeeds<br>
    DHE_NOTHINGTODO If the DMX levels are the same as before.<br>
    DHE_ERROR_NOTOPEN&nbsp; If the interface is not open.<br>
    DHE_DMXOUT_PACKWRITE&nbsp; If the communication fails.</font></td>
  </tr>
  <tr>
    <td width="11%"><font face="Arial" size="1">DHC_PORTCONFIG</font></td>
    <td width="25%"><font face="Arial" size="1">allow to set the input/output mode and the
    state of the 8 ports</font></td>
    <td width="25%"><font face="Arial" size="1">USBDMX1</font></td>
    <td width="28%"><font face="Arial" size="1">Set an integer from 0 to 65535 (16bits).<br>
    The low byte specifies the input/output mode of the 8 ports. (0=input, 1=output)<br>
    The high byte specifies the state of the 8 ports. (0=off, 1=on)</font></td>
    <td width="14%"><font face="Arial" size="1">not used</font></td>
    <td width="38%"><font face="Arial" size="1">DHE_OK&nbsp; If the function succeeds.<br>
    DHE_ERROR_NOTOPEN&nbsp; If the interface is not open.<br>
    DHE_ERROR_COMMAND&nbsp; If the function fails.</font></td>
  </tr>
  <tr>
    <td width="11%"><font face="Arial" size="1">DHC_PORTREAD</font></td>
    <td width="25%"><font face="Arial" size="1">allow to read the state of the 8 ports and the
    Next/Previous buttons</font></td>
    <td width="25%"><font face="Arial" size="1">USBDMX1</font></td>
    <td width="28%"><font face="Arial" size="1">not used</font></td>
    <td width="14%"><font face="Arial" size="1">not used</font></td>
    <td width="38%"><font face="Arial" size="1">DHE_ERROR_NOTOPEN&nbsp; If the interface is
    not open.<br>
    If the function succeeds, the return value is from 0 to 1023 (10bits), Bit0=NEXT,
    Bit1=PREVIOUS, Bit2-9=State of 8ports </font></td>
  </tr>
  <tr>
    <td width="11%"><font face="Arial" size="1">DHC_VERSION</font></td>
    <td width="25%"><font face="Arial" size="1">return the firmware version</font></td>
    <td width="25%"><font face="Arial" size="1">USBDMX1&nbsp; </font></td>
    <td width="28%"><font face="Arial" size="1">not used</font></td>
    <td width="14%"><font face="Arial" size="1">not used</font></td>
    <td width="38%"><font face="Arial" size="1">Return 10 with firmware dated
      4-may 2000<br>
      Return 11 with firmware dated 31-jan 2001<br>
      With USBDMX2 and  return DHE_NOTHINGTODO&nbsp;</font></td>
  </tr>

  <tr>
    <td width="11%"><font face="Arial" size="1">DHC_DEBUG_OPEN</font></td>
    <td width="25%"><font face="Arial" size="1">open the debug mode and create a file named
    "debug.txt"</font></td>
    <td width="25%"><font face="Arial" size="1">ALL INTERFACES</font></td>
    <td width="28%"><font face="Arial" size="1">not used</font></td>
    <td width="14%"><font face="Arial" size="1">not used</font></td>
    <td width="38%"><font face="Arial" size="1">return DHE_OK always</font></td>
  </tr>
  <tr>
    <td width="11%"><font face="Arial" size="1">DHC_DEBUG_CLOSE</font></td>
    <td width="25%"><font face="Arial" size="1">close the debug mode<br>
    </font></td>
    <td width="25%"><font face="Arial" size="1">ALL INTERFACES</font></td>
    <td width="28%"><font face="Arial" size="1">not used</font></td>
    <td width="14%"><font face="Arial" size="1">not used</font></td>
    <td width="38%"><font face="Arial" size="1">return DHE_OK always</font></td>
  </tr>
  <tr>
    <td width="11%"><font face="Arial" size="1">DHC_WRITEMEMORY</font></td>
    <td width="25%"><font face="Arial" size="1">allow to write the stand alone memory.</font></td>
    <td width="25%"><font face="Arial" size="1">USBDMX1&nbsp; </font></td>
    <td width="28%"><font face="Arial" size="1">Specifies the size, in bytes, of the block of
    memory to write.</font></td>
    <td width="14%"><font face="Arial" size="1">Pointer to the block of memory</font></td>
    <td width="38%"><font face="Arial" size="1">DHE_OK&nbsp; If the function succeeds.<br>
    DHE_ERROR_NOTOPEN&nbsp; If the interface is not open.<br>
    DHE_ERROR_COMMAND&nbsp; If the function fails.</font></td>
  </tr>
  <tr>
    <td width="11%"><font face="Arial" size="1">DHC_READMEMORY</font></td>
    <td width="25%"><font face="Arial" size="1">allow to read the stand alone memory.</font></td>
    <td width="25%"><font face="Arial" size="1">USBDMX1&nbsp; </font></td>
    <td width="28%"><font face="Arial" size="1">Specifies the size, in bytes, of the block of
    memory to read.</font></td>
    <td width="14%"><font face="Arial" size="1">Pointer to the block of memory</font></td>
    <td width="38%"><font face="Arial" size="1">DHE_OK&nbsp; If the function succeeds.<br>
    DHE_ERROR_NOTOPEN&nbsp; If the interface is not open.<br>
    DHE_ERROR_COMMAND&nbsp; If the function fails.</font></td>
  </tr>
  <tr>
    <td width="11%"><font face="Arial" size="1">DHC_SIZEMEMORY</font></td>
    <td width="25%"><font face="Arial" size="1">allow to know the size of the stand alone
    memory.</font></td>
    <td width="25%"><font face="Arial" size="1">USBDMX1&nbsp; </font></td>
    <td width="28%"><font face="Arial" size="1">not used</font></td>
    <td width="14%"><font face="Arial" size="1">not used</font></td>
    <td width="38%"><font face="Arial" size="1">DHE_ERROR_NOTOPEN&nbsp; If the interface is
    not open.<br>
    return the size, in bytes, of the stand alone memory.</font></td>
  </tr>
</tbody></table>

<p><u><font face="Arial" size="1">Remarks:<br>
</font></u><font face="Arial" size="1">- All the constants&nbsp; DHC_OPEN,&nbsp;
DHC_CLOSE,&nbsp; DHE_OK ....&nbsp;&nbsp;&nbsp;&nbsp; are defined in the
"_DasHard.h" include file.</font></p><p>


<table>
<tbody><tr><td><font face="Arial" size="1"> DHC_OPEN			</font></td><td><font face="Arial" size="1">	1		</font></td><td><font face="Arial" size="1">// COMMAND</font></td></tr> 
<tr><td><font face="Arial" size="1"> DHC_CLOSE			</font></td><td><font face="Arial" size="1">	2		</font></td><td><font face="Arial" size="1">// COMMAND</font></td></tr>
<tr><td><font face="Arial" size="1"> DHC_DMXOUTOFF		</font></td><td><font face="Arial" size="1">	3		</font></td><td><font face="Arial" size="1">// COMMAND</font></td></tr>
<tr><td><font face="Arial" size="1"> DHC_DMXOUT			</font></td><td><font face="Arial" size="1">	4		</font></td><td><font face="Arial" size="1">// COMMAND</font></td></tr>
<tr><td><font face="Arial" size="1"> DHC_PORTREAD		</font></td><td><font face="Arial" size="1">	5		</font></td><td><font face="Arial" size="1">// COMMAND</font></td></tr>
<tr><td><font face="Arial" size="1"> DHC_PORTCONFIG		</font></td><td><font face="Arial" size="1">	6		</font></td><td><font face="Arial" size="1">// COMMAND</font></td></tr>
<tr><td><font face="Arial" size="1"> DHC_VERSION			</font></td><td><font face="Arial" size="1">	7		</font></td><td><font face="Arial" size="1">// COMMAND</font></td></tr>

<tr><td><font face="Arial" size="1"> DHC_RESET			</font></td><td><font face="Arial" size="1">	11		</font></td><td><font face="Arial" size="1">// COMMAND</font></td></tr>
<tr><td><font face="Arial" size="1"> DHC_DEBUG_OPEN		</font></td><td><font face="Arial" size="1">	12		</font></td><td><font face="Arial" size="1">// COMMAND</font></td></tr>
<tr><td><font face="Arial" size="1"> DHC_DEBUG_CLOSE		</font></td><td><font face="Arial" size="1">	13		</font></td><td><font face="Arial" size="1">// COMMAND</font></td></tr>

<tr><td><font face="Arial" size="1"> DHC_WRITEMEMORY		</font></td><td><font face="Arial" size="1">	21		</font></td><td><font face="Arial" size="1">// COMMAND</font></td></tr>
<tr><td><font face="Arial" size="1"> DHC_READMEMORY		</font></td><td><font face="Arial" size="1">	22		</font></td><td><font face="Arial" size="1">// COMMAND</font></td></tr>
<tr><td><font face="Arial" size="1"> DHC_SIZEMEMORY		</font></td><td><font face="Arial" size="1">	23		</font></td><td><font face="Arial" size="1">// COMMAND</font></td></tr>

<tr><td><font face="Arial" size="1"> DHC_TRANSPORT		</font></td><td><font face="Arial" size="1">	30		</font></td><td><font face="Arial" size="1">// COMMAND</font></td></tr>
<tr><td><font face="Arial" size="1"> DHP_TRANSPORT_MODEALW	</font></td><td><font face="Arial" size="1">	1		</font></td><td><font face="Arial" size="1">// PARAM</font></td></tr>
<tr><td><font face="Arial" size="1"> DHP_TRANSPORT_MODEALW32</font></td><td><font face="Arial" size="1">	2		</font></td><td><font face="Arial" size="1">// PARAM</font></td></tr>
<tr><td><font face="Arial" size="1"> DHP_TRANSPORT_MODEOPT	</font></td><td><font face="Arial" size="1">	3		</font></td><td><font face="Arial" size="1">// PARAM (DEFAULT)</font></td></tr> 
<tr><td><font face="Arial" size="1"> DHP_TRANSPORT_MODEOPT32	</font></td><td><font face="Arial" size="1">	4		</font></td><td><font face="Arial" size="1">// PARAM</font></td></tr>

<tr><td><font face="Arial" size="1"> DHC_SERIALNREAD		</font></td><td><font face="Arial" size="1"><font face="Arial" size="1">	47		</font></font></td><td><font face="Arial" size="1">// COMMAND</font></td></tr>
<tr><td><font face="Arial" size="1"> DHC_SERIALNWRITE		</font></td><td><font face="Arial" size="1">	48		</font></td><td><font face="Arial" size="1">// COMMAND</font></td></tr>

<tr><td><font face="Arial" size="1"> DHE_OK			</font></td><td><font face="Arial" size="1">	1		</font></td><td><font face="Arial" size="1">// RETURN NO ERROR</font></td></tr>
<tr><td><font face="Arial" size="1"> DHE_NOTHINGTODO		</font></td><td><font face="Arial" size="1">	2		</font></td><td><font face="Arial" size="1">// RETURN NO ERROR</font></td></tr>

<tr><td><font face="Arial" size="1"> DHE_ERROR_COMMAND	</font></td><td><font face="Arial" size="1">	-1		</font></td><td><font face="Arial" size="1">// RETURN ERROR</font></td></tr>
<tr><td><font face="Arial" size="1"> DHE_ERROR_NOTOPEN		</font></td><td><font face="Arial" size="1">	-2		</font></td><td><font face="Arial" size="1">// RETURN ERROR</font></td></tr>
<tr><td><font face="Arial" size="1"> DHE_DMXOUT_PACKWRITE	</font></td><td><font face="Arial" size="1">	-1000		</font></td><td><font face="Arial" size="1">// RETURN ERROR   </font></td></tr>
<tr><td><font face="Arial" size="1"> 				</font></td><td><font face="Arial" size="1">	-1005 		</font></td><td><font face="Arial" size="1">// ERROR_ACCESS_DENIED  </font></td></tr>
<tr><td><font face="Arial" size="1"> 				</font></td><td><font face="Arial" size="1">	-1023 		</font></td><td><font face="Arial" size="1">// ERROR_CRC</font></td></tr>
<tr><td><font face="Arial" size="1"> DHE_DMXOUT_PACKREAD	</font></td><td><font face="Arial" size="1">	-1100		</font></td><td><font face="Arial" size="1">// RETURN ERROR</font></td></tr>
</tbody></table>
</p><p>


</p><p><font face="Arial" size="1"><u>You can use up to 10 USB interfaces at the
same time</u>.<br>
To do this,
just add a value in the &lt;command&gt; parameter :<br>
- add 100 (DHC_USBDMX11) if you want to use the interface #2<br>
- add 200 (DHC_USBDMX12) if you want to use the interface #3 ...<br>
Example:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DasHardCommand( DHC_USBDMX11+DHC_OPEN&nbsp;
,&nbsp;&nbsp; 0&nbsp; ,&nbsp; 0 )&nbsp;&nbsp; open the </font><font face="Arial" size="1"> the interface #2</font></p>

<hr>

<p><font face="Arial"><big><big>Example of code using our DLL&nbsp; -&nbsp; C++ style</big></big></font></p>

<hr>

<p><big><big><font face="Arial">Open the interface when your application start :</font></big></big></p>

<p><font face="Courier">&nbsp;&nbsp;&nbsp;&nbsp; int interface_open;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font><font face="Arial" size="1">// global<br>
&nbsp;&nbsp;&nbsp;&nbsp; unsigned char dmxblock[512];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font face="Arial" size="1">// global<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; interface_open = HardDllCommand(DHC_OPEN,0,0);<br>
&nbsp;&nbsp;&nbsp;&nbsp; if (interface_open&gt;0) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for(int i=0;i&lt;512;i++)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
dmxblock[i] = 0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int v =
HardDllCommand(DHC_DMXOUTOFF,0,0);<br>
&nbsp;&nbsp;&nbsp;&nbsp; <sup>}</sup><br>
</font><font face="Arial" size="2"><u>Note :<br>
</u>- When you open the interface, you don't know the state of the DMX output levels into
the interface. It's why it's better to clean all DMX levels to be sure.</font></p>

<hr>

<p><font face="Arial"><big><big>Send the DMX and read the PORT everytime :</big></big></font></p>

<p><font face="Courier">&nbsp;&nbsp;&nbsp;&nbsp; int v,ports;<br>
&nbsp;&nbsp;&nbsp;&nbsp; if (interface_open&gt;0) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ports =
HardDllCommand(DHC_PORTREAD,0,0);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v = HardDllCommand(DHC_DMXOUT, 512,
dmxblock);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (v&lt;0) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v =
HardDllCommand(DHC_CLOSE,0,0);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v =
HardDllCommand(DHC_OPEN,0,0);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp; <sup>}</sup><br>
</font><font face="Arial" size="2"><u>Note :<br>
</u>- When you use the DHC_DMXOUT command, the DLL analyses your DMX block. If there is no
changes on the DMX levels, the function returns DHE_NOTHINGTODO and the DLL don't make a
USB communication to save the CPU time of your computer. <br>
- After 6 seconds without USB communication, the USBDMX1 and  interfaces go
in stand alone mode (it's
a nice feature, if the computer fails). It's why we propose to read the state of the port
everytime to force a USB communication, with this, the interface do not go in
stand alone mode.<br>
- If the DHC_DMXOUT command&nbsp; fails (for example, if the user unplug the USB interface
!), you need to close and try to open again the interface.</font></p>

<hr>

<p><big><big><font face="Arial">Close the interface when your application finish :</font></big></big></p>

<p><font face="Courier">&nbsp;&nbsp;&nbsp;&nbsp; int v;<br>
&nbsp;&nbsp;&nbsp;&nbsp; if (interface_open&gt;0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v = HardDllCommand(DHC_CLOSE,0,0);</font></p>

<hr>

<p><font face="Arial">Copyright&nbsp;(c) Digital Art System, 1998-2002<br>
</font></p></body></html>